function [M1,M2] = MomentsRaw3(l1,l2,l3)
    
    % first raw moment
    M11 = @(x0,D1,D2,D3) (0.1e1/D1*l1+0.1e1/D1*l2+0.1e1/D1*l3).*x0-0.1e1/D1*x0.^2/0.2e1;
    M12 = @(x0,D1,D2,D3) -0.1e1/D2*l1^2/0.2e1-l1/D2*l2-l1/D2*l3+0.1e1/D1*l1^2/0.2e1+l1/D1*l2+l1/D1*l3+(0.1e1/D2*l1+0.1e1/D2*l2+0.1e1/D2*l3).*x0-0.1e1/D2*x0.^2/0.2e1;
    M13 = @(x0,D1,D2,D3) -0.1e1/D3*l1^2/0.2e1-0.1e1/D3*l1*l2-0.1e1/D3*l1*l3-0.1e1/D3*l2^2/0.2e1-0.1e1/D3*l2*l3+0.1e1/D2*l2^2/0.2e1+0.1e1/D2*l2*l3+0.1e1/D1*l1^2/ 0.2e1+l1/D1*l2+l1/D1*l3+(0.1e1/D3*l1+0.1e1/D3*l2+0.1e1/D3*l3).*x0-0.1e1/D3*x0.^2/0.2e1;
    M1 = @(x0,p1,p2,p3) (x0<l1)*M11(x0,p1,p2,p3)+(x0>=l1 && x0 < l1+l2)*M12(x0,p1,p2,p3)+(x0>=l1+l2 && x0 <= l1+l2+l3)*M13(x0,p1,p2,p3);

    % second raw moment
    M21 = @(x0,D1,D2,D3) (0.2e1/0.3e1/D1/D3*l3^3+0.2e1/0.3e1/D2/D1*l2^3+0.2e1/D2/D1*l2^2*l3+0.2e1/D2/D1*l2*l3^2+0.2e1/0.3e1/D1^2*l1^3+0.2e1/D1^2*l1^2*l2+0.2e1/D1^2*l1^2*l3+0.2e1/D1^2*l1*l2^2+0.4e1/D1^2*l1*l2*l3+0.2e1/D1^2*l1*l3^2).*x0+(-0.1e1/D1^2*l1/0.3e1-0.1e1/D1^2*l2/0.3e1-0.1e1/D1^2*l3/0.3e1)*x0.^3+0.1e1/D1^2*x0.^4/0.12e2; 
    M22 = @(x0,D1,D2,D3) -(2*l1/D2^2*l2^2*l3)-(2*l1/D2^2*l2*l3^2)-(4*l1^2/D2/D1*l2*l3)+(2*l1/D2/D1*l2^2*l3)+(2*l1/D2/D1*l2*l3^2)+(4*l1^2/D1^2*l2*l3)-0.2e1/0.3e1/D3*l1/D2*(l3^3)+(l1^3/D2^2*l2)/0.3e1+(l1^3/D2^2*l3)/0.3e1-0.2e1/0.3e1*l1/(D2^2)*(l2^3)+0.2e1/0.3e1/D3*l1/D1*(l3^3)-(2*l1^3/D2/D1*l2)-(2*l1^3/D2/D1*l3)-(2*l1^2/D2/D1*l2^2)-(2*l1^2/D2/D1*l3^2)+0.2e1/0.3e1*l1/D2/D1*(l2^3)+0.5e1/0.3e1*(l1^3)/(D1^2)*l2+0.5e1/0.3e1*(l1^3)/(D1^2)*l3+(2*l1^2/D1^2*l2^2)+(2*l1^2/D1^2*l3^2)+(l1^4/D2^2)/0.12e2-(l1^4/D2/D1)/0.2e1+0.5e1/0.12e2*(l1^4)/(D1^2)+(-(1/D2^2*l1^2*l2)-(1/D2^2*l1^2*l3)+(2/D2^2*l2^2*l3)+(2/D2^2*l2*l3^2)+(3/D1/D2*l1^2*l2)+(3/D1/D2*l1^2*l3)+(2/D1/D2*l1*l2^2)+(2/D1/D2*l1*l3^2)+(4/D1/D2*l1*l2*l3)+0.2e1/0.3e1/D2/D3*(l3^3)-(1/D2^2*l1^3)/0.3e1+0.2e1/0.3e1/(D2^2)*(l2^3)+(1/D1/D2*l1^3)).*x0+((1/D2^2*l1^2)/0.2e1-(1/D2*l1/D1*l2)-(1/D2*l1/D1*l3)+(1/D2^2*l1*l2)+(1/D2^2*l1*l3)-(1/D2*l1^2/D1)/0.2e1)*x0.^2+(-(1/D2^2*l3)/0.3e1-(1/D2^2*l1)/0.3e1-(1/D2^2*l2)/0.3e1)*x0.^3+0.1e1/(D2^2)*x0.^4/0.12e2; 
    M23 = @(x0,D1,D2,D3) (l1^2/D2/D1*l2*l3)+(5*l1/D2/D1*l2^2*l3)+(4*l1/D2/D1*l2*l3^2)+(4*l1^2/D1^2*l2*l3)+(1/D3^2*l1^2*l2*l3)+(1/D3^2*l1*l2^2*l3)-(1/D2/D3*l1^2*l2*l3)-(3/D2/D3*l1*l2^2*l3)-(2/D2/D3*l1*l2*l3^2)-(5/D1/D3*l1^2*l2*l3)-(3/D1/D3*l1*l2^2*l3)-(2/D1/D3*l1*l2*l3^2)+(1/D3^2*l1^3*l2)/0.3e1+(1/D3^2*l1^3*l3)/0.3e1+(1/D3^2*l1^2*l2^2)/0.2e1+(1/D3^2*l1*l2^3)/0.3e1-0.2e1/0.3e1/(D3^2)*l1*(l3^3)+(1/D3^2*l2^3*l3)/0.3e1-0.2e1/0.3e1/(D3^2)*l2*(l3^3)-(1/D2/D3*l1^2*l2^2)/0.2e1-(1/D2/D3*l1*l2^3)-(2/D2/D3*l2^3*l3)-(2/D2/D3*l2^2*l3^2)+0.2e1/0.3e1/D2/D3*l2*(l3^3)+0.5e1/0.3e1/(D2^2)*(l2^3)*l3+(2/D2^2*l2^2*l3^2)-(2/D1/D3*l1^3*l2)-(2/D1/D3*l1^3*l3)-0.5e1/0.2e1/D1/D3*(l1^2)*(l2^2)-(2/D1/D3*l1^2*l3^2)-(1/D1/D3*l1*l2^3)+0.5e1/0.3e1*(l1^3)/(D1^2)*l2+0.5e1/0.3e1*(l1^3)/(D1^2)*l3+(2*l1^2/D1^2*l2^2)+(2*l1^2/D1^2*l3^2)+0.2e1/0.3e1/D3*l1/D1*(l3^3)+(l1^2/D2/D1*l2^2)/0.2e1+0.5e1/0.3e1*l1/D2/D1*(l2^3)+(1/D3^2*l1^4)/0.12e2+(1/D3^2*l2^4)/0.12e2-(1/D2/D3*l2^4)/0.2e1+0.5e1/0.12e2/(D2^2)*(l2^4)-(1/D1/D3*l1^4)/0.2e1+0.5e1/0.12e2*(l1^4)/(D1^2)+(-(1/D3^2*l1^2*l2)-(1/D3^2*l1^2*l3)-(1/D3^2*l1*l2^2)-(1/D3^2*l2^2*l3)+(1/D3/D2*l1*l2^2)+(3/D3/D2*l2^2*l3)+(2/D3/D2*l2*l3^2)+(3/D3/D1*l1^2*l2)+(3/D3/D1*l1^2*l3)+(2/D3/D1*l1*l2^2)+(2/D3/D1*l1*l3^2)-(1/D3^2*l1^3)/0.3e1-(1/D3^2*l2^3)/0.3e1+0.2e1/0.3e1/(D3^2)*(l3^3)+(1/D3/D2*l2^3)+(1/D3/D1*l1^3)-(2/D3^2*l1*l2*l3)+(2/D3/D2*l1*l2*l3)+(4/D3/D1*l1*l2*l3)).*x0+(-(1/D3/D2*l2*l3)-(1/D3*l1/D1*l2)-(1/D3*l1/D1*l3)+(1/D3^2*l2^2)/0.2e1+(1/D3^2*l1^2)/0.2e1+(1/D3^2*l1*l2)+(1/D3^2*l1*l3)+(1/D3^2*l2*l3)-(1/D3/D2*l2^2)/0.2e1-(1/D3*l1^2/D1)/0.2e1)*x0.^2+(-(1/D3^2*l2)/0.3e1-(1/D3^2*l3)/0.3e1-(1/D3^2*l1)/0.3e1)*x0.^3+0.1e1/(D3^2)*x0.^4/0.12e2;
    M2 = @(x0,p1,p2,p3) (x0<l1)*M21(x0,p1,p2,p3)+(x0>=l1 && x0 < l1+l2)*M22(x0,p1,p2,p3)+(x0>=l1+l2 && x0 <= l1+l2+l3)*M23(x0,p1,p2,p3);

end

